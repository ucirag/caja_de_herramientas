<head>
  <meta charset="utf-8">
  <title>Gu√≠a UCIRAG</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono&display=swap');

    body {
      font-family: 'IBM Plex Mono', monospace;
      background-color: #f9f9f9;
      color: #2c3e50;
      line-height: 1.6;
      max-width: 850px;
      margin: auto;
      padding: 40px;
    }

    h1, h2, h3 {
      color: #1a5276;
      border-bottom: 1px solid #ddd;
      padding-bottom: 0.3em;
    }

    code {
      background-color: #eee;
      padding: 0.2em 0.4em;
      border-radius: 4px;
      font-family: monospace;
    }

    pre {
      background-color: #eee;
      padding: 1em;
      border-radius: 4px;
      overflow-x: auto;
    }

    ul, ol {
      padding-left: 2em;
    }

    hr {
      border: 0;
      border-top: 1px solid #ccc;
      margin: 2em 0;
    }

    a {
      color: #007acc;
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    .footnotes {
      font-size: 0.9em;
      color: #555;
    }

    .footnotes hr {
      margin-top: 3em;
    }
  </style>
</head>



<h1><strong>Gu√≠a te√≥rico-conceptual para el an√°lisis epidemiol√≥gico de Infecciones Respiratorias Agudas Graves (IRAG)</strong></h1>


<p>
<strong>Utilizando informaci√≥n del SNVS 2.0</strong>
</p>
<h2><strong>Introducci√≥n</strong></h2>


<p>
Esta gu√≠a forma parte de la caja de herramientas desarrollada para el an√°lisis estandarizado de IRAG a partir de datos provenientes del SNVS 2.0. Su objetivo es brindar un marco te√≥rico-metodol√≥gico que respalde el desarrollo del bolet√≠n epidemiol√≥gico automatizado, incluyendo supuestos, transformaciones y definiciones utilizadas en los scripts de procesamiento.
</p>
<p>
Se recomienda su lectura luego de consultar el documento <strong>README.md</strong> y de manera complementaria a la <strong>Gu√≠a Operativa</strong>.
</p>
<h2><strong>1. Origen y caracter√≠sticas de los datos</strong></h2>


<h3><strong>1.1 Base VR_NOMINAL</strong></h3>


<p>
Los datos nominales de casos IRAG se extraen de la base <code>VR_NOMINAL.csv</code>. La mayor√≠a de sus variables est√°n definidas en el documento:<br> <strong>Gu√≠a Operativa Vigilancia Centinela de IRAG. Anexo: Diccionario de variables (Mayo 2024)<br></strong> üìé<a href="https://www.argentina.gob.ar/sites/default/files/guia-uc-irag-diccionario-de-variables.pdf"> Enlace al anexo</a>
</p>
<h3><strong>1.2 Archivos de soporte</strong></h3>


<ul>

<li><code>AREA_PROGRAMA.xls</code>: archivo que permite mapear cada localidad a un √°rea programa, asociada al hospital cabecera.<br></li>

<li><code>EFECTORES.xlsx</code>: listado de efectores utilizado para georreferenciaci√≥n.<br></li>

<li><code>NEUQUEN_CLI_INTERNACIONES.csv</code>: datos agrupados por internaci√≥n, ajustables a cada provincia.<br></li>

<li><code>INTERNACION POR SERVICIO.csv</code>: opcional, describe internaciones y % de hisopados por servicio.</li>
</ul>
<h2><strong>2. Par√°metros del an√°lisis</strong></h2>


<p>
r
</p>
<p>
CopiarEditar
</p>



<pre class="prettyprint">PROVINCIA &lt;- 58
DEPTOS_ANALISIS &lt;- c("58007","58021","58105","58112")
anio_de_analisis &lt;- 2024
fecha_de_descarga &lt;- 2024 # poner aca la fecha en la que se descargo el dataset
num_semana_previas_no_incluidas &lt;- 2
edad_max &lt;- 110

<ul>

<li>PROVINCIA: c√≥digo de provincia a analizar seleccionado por el usuario. Todos los resultados tendr√°n aplicado este filtro. 
</pre>

</li>

<li><strong>DEPTOS_ANALISIS</strong>: ID de departamentos a incluir.Todos los resultados tendr√°n aplicado este filtro al departamento de residencia.</li>

<li><strong>anio_de_analisis</strong>: a√±o del an√°lisis seleccionado para el estudio. Los resultados se presentaran para este a√±o seleccionado. En determinados analisis se incluira el a√±o previo al a√±o seleccionado para su comparaci√≥n.</li>

<li><strong>num_semana_previas_no_incluidas</strong>: Todos los resultados incluiran el filtro de semanas excluidas para evitar sesgos por demora en la carga.  Por ejemplo, si este parametro vale  2, se excluyen del analisis las 2 ultimas semanas epidemiologicas (la semana en curso + la semana cerrada previa) respecto a la <code>fecha_de_descarga </code>del sistema de informaci√≥n. </li>
</ul>
<h2><strong>3. Transformaciones de datos y nuevas variables</strong></h2>


<p>
A continuacion se listan y definien todas las nuevas variables generadas para el analisis que estaran disponibles en VR_NOMINAL_EVENTOCASO_FECHA.xlsx en la carpeta de salidas. 
</p>
<h3><strong>3.1 Variables de fechas</strong></h3>


<ul>

<li><strong>FECHA_CREADA</strong>: se genera con prioridad sobre FIS ‚Üí FECHA_CONSULTA ‚Üí DIAGN√ìSTICO ‚Üí APERTURA.<br></li>

<li><strong>SEPI_CREADA</strong>: semana epidemiol√≥gica correspondiente a la FECHA_CREADA .<br></li>

<li><strong>A√ëO</strong>: extra√≠do de FECHA_CREADA.<br></li>

<li><strong>EDAD</strong>: calculada como diferencia entre FECHA_CREADA y FECHA_NACIMIENTO. Lo valores NA de esta variables corresponde a datos faltantes en variable  FECHA_NACIMIENTO o a un valor de edad que supera el parametro <code>edad_max</code>, que por defecto es 110. <br></li>

<li><strong>UNIDEDAD</strong>: Representa la unidad en la que se registra la edad en la variable EDAD. Toma los siguientes valores :  1 si edad est√° registrada en meses, 2 si est√° registrada en a√±os.<br></li>
</ul>
<h3><strong>3.2 Grupos de edad</strong></h3>


<ul>

<li><strong>GRUPO_ETARIO2</strong>: pensado para evaluar efectividad de vacuna VSR.<br></li> 
<ul>
 
<li>&lt;6 meses, 6m-&lt;2a, 2‚Äì4a, 5‚Äì9a, 10‚Äì14a, 15‚Äì19a, etc.<br></li> 
</ul>

<li><strong>GRUPO</strong>: gen√©rico para an√°lisis poblacional.<br></li> 
<ul>
 
<li>10‚Äì14, 25‚Äì34, 35‚Äì44, >65.</li> 
</ul></li> 
</ul>
<h2><strong>4. Transformaci√≥n de registros m√∫ltiples.</strong></h2>


<p>
En el sistema de vigilancia IRAG, las variables <strong>SIGNO_SINTOMAS</strong>, <strong>COMORBILIDAD</strong> y <strong>DETERMINACI√ìN</strong> se registran en formato multiregistro, es decir, cada evento puede tener m√∫ltiples registros asociados a distintas categor√≠as de cada una de estas variables (que fueros registradas con opcion multiple). Este formato, aunque √∫til para carga y almacenamiento, no es √≥ptimo para el an√°lisis automatizado o tabulaci√≥n directa. Por ello, se implementa un proceso de transformaci√≥n que convierte a los niveles de estas variables en columnas dicot√≥micas de una base plana, donde cada fila representa un evento √∫nico (IDEVENTOCASO unico).
</p>
<h4><strong>Objetivo de la transformaci√≥n</strong></h4>


<p>
La finalidad de este proceso es:
</p>
<ul>

<li>Facilitar el an√°lisis por evento (unidad de an√°lisis).<br></li>

<li>Permitir la aplicaci√≥n directa de funciones estad√≠sticas, filtros y visualizaciones sobre s√≠ntomas, comorbilidades y determinaciones.<br></li>

<li>Estandarizar la estructura de la base para mejorar su legibilidad y compatibilidad con otras herramientas.</li>
</ul>
<h4><strong>Descripci√≥n del proceso</strong></h4>


<p>
Para las variables <code>SIGNO_SINTOMAS</code> y <code>COMORBILIDAD</code>, cada categor√≠a observada se transforma en una <strong>columna binaria</strong> que indica su presencia (<code>1</code>) o ausencia (<code>0</code>) en ese evento.
</p>
<p>
En cambio, en el caso de <code>DETERMINACI√ìN</code>, cada categor√≠a se transforma en una columna <strong>que toma el valor del resultado asociado</strong> (por ejemplo: <code>"Detectable"</code>, <code>"No detectable"</code>, <code>"Positivo"</code>), extra√≠do de la columna <code>RESULTADO</code>.
</p>

<table>
  <tr>
   <td><strong>Variable original</strong>
   </td>
   <td><strong>Prefijo generado</strong>
   </td>
   <td><strong>Ejemplo de columna creada</strong>
   </td>
   <td><strong>Valor posible</strong>
   </td>
  </tr>
  <tr>
   <td>SIGNO_SINTOMAS
   </td>
   <td><code>SINTOMA_</code>
   </td>
   <td><code>SINTOMA_Fiebre</code>
   </td>
   <td>1 / 0
   </td>
  </tr>
  <tr>
   <td>COMORBILIDAD
   </td>
   <td><code>COMORB_</code>
   </td>
   <td><code>COMORB_Asma</code>
   </td>
   <td>1 / 0
   </td>
  </tr>
  <tr>
   <td>DETERMINACI√ìN
   </td>
   <td><code>DETERMINACION_</code>
   </td>
   <td><code>DETERMINACION_Genoma_SARS_CoV2</code>
   </td>
   <td>"Detectable", "No detectable", etc.
   </td>
  </tr>
</table>


<p>
üîç Importante: las nuevas variables <strong>no se basan en un diccionario predefinido</strong>, sino que se generan din√°micamente seg√∫n las categor√≠as existentes en el conjunto de datos original (VR_NOMINAL). Esto implica que nuevos niveles detectadas en futuras cargas generar√°n autom√°ticamente nuevas columnas.
</p>
<h4><strong>L√≥gica de asignaci√≥n</strong></h4>


<ul>

<li>Para las columnas <code>SINTOMA_</code> y <code>COMORB_</code>, se asigna:<br></li> 
<ul>
 
<li><code>1</code> si la categor√≠a est√° presente para el evento.<br></li>
 
<li><code>0</code> si est√° ausente.<br></li> 
</ul>

<li>Para las columnas <code>DETERMINACION_</code>, los valores pueden ser:<br></li> 
<ul>
 
<li><code>"Positivo"</code> o <code>"Detectable"<br></code></li>
 
<li><code>"Negativo"</code> o <code>"No detectable"<br></code></li>
 
<li><code>"Pendiente de revisi√≥n"</code>: utilizado como marca de alerta ante datos incompletos o contradictorios.</li>
 
<li><code>NA : </code>Sin registro de determinaci√≥n.</li> 
</ul></li> 
</ul>
<p>


<p id="gdcalert1" ><span style="color: red; font-weight: bold">>>>>>  gd2md-html alert: inline drawings not supported directly from Docs. You may want to copy the inline drawing to a standalone drawing and export by reference. See <a href="https://github.com/evbacher/gd2md-html/wiki/Google-Drawings-by-reference">Google Drawings by reference</a> for details. The img URL below is a placeholder. </span><br>(<a href="#">Back to top</a>)(<a href="#gdcalert2">Next alert</a>)<br><span style="color: red; font-weight: bold">>>>>> </span></p>


<img src="https://docs.google.com/drawings/d/12345/export/png" width="80%" alt="drawing">

</p>
<h4><strong>Variables complementarias generadas</strong></h4>


<ul>

<li><code>DETERMINACION_SIN_DATO</code>:<br> Variable que toma el valor <code>1</code> cuando <strong>no hay ninguna determinaci√≥n cargada</strong> para el evento. Esta informaci√≥n es clave para evaluar la completitud del registro y para excluir casos no estudiados.<br></li>

<li><code>determinacion_dico</code>:<br> Variable resumen que toma:<br></li> 
<ul>
 
<li><code>1</code> si <strong>alguna</strong> columna <code>DETERMINACION_</code> tiene resultado Positivo/Detectable.<br></li>
 
<li><code>0</code> si <strong>todas</strong> las determinaciones presentes son Negativas/No detectables.<br></li>
 
<li><code>99</code> si <code>DETERMINACION_NINGUNA == 1</code>.<br>
<h4>
        <strong>Automatizaci√≥n del proceso</strong></h4>

</li> 
</ul></li> 
</ul>
<p>
Todo el procedimiento est√° encapsulado en la funci√≥n <code>funcion_procesa_sintomas_mejorada.R</code>, la cual:
</p>
<ul>

<li>Aplica la transformaci√≥n multiregistro ‚Üí base plana.<br></li>

<li>Crea autom√°ticamente las columnas necesarias.<br></li>

<li>Maneja casos incompletos o inconsistentes.<br></li>

<li>Devuelve una base de eventos lista para an√°lisis.</li> 
<ul>
 
<li></li> 
</ul></li> 
</ul>
<h2><strong>5. Variables clave del an√°lisis</strong></h2>


<ul>

<li><strong>DETERMINACION_NINGUNA</strong>: vale 1 si el evento no tiene determinaciones cargadas.<br></li>

<li><strong>determinacion_dico</strong>: variable resumen:<br></li> 
<ul>
 
<li>1 si hay al menos un resultado Positivo/Detectable<br></li>
 
<li>0 si todos los resultados son Negativos/No detectables<br></li>
 
<li>99 si no hay ninguna determinaci√≥n<br></li> 
</ul>

<li><strong>CALIDAD_TOMA_PCR</strong>: vale 1 si hay PCR para los tres virus centinela (COVID, Influenza, VSR).</li>
</ul>
<h2><strong>6. An√°lisis espacial y generaci√≥n de mapas</strong></h2>


<p>
Como parte del informe final, se incluy√≥ una secci√≥n con mapas tem√°ticos que permiten visualizar la distribuci√≥n de casos, signos y s√≠ntomas, determinaciones positivas y otras variables relevantes, seg√∫n unidades geogr√°ficas subnacionales.
</p>
<h4><strong>Obtenci√≥n de l√≠mites administrativos</strong></h4>


<p>
Para la construcci√≥n de los mapas, se utilizaron l√≠mites administrativos de segundo nivel (departamentos) provistos por el Instituto Geogr√°fico Nacional (IGN). Se desarroll√≥ una <strong>funci√≥n personalizada en R</strong> que accede din√°micamente a los datos geoespaciales mediante el servicio <strong>WFS (Web Feature Service)</strong> del IGN, montado sobre una plataforma GeoServer.
</p>
<p>
Esta funci√≥n permite <strong>filtrar y descargar directamente desde el servidor solo la informaci√≥n geogr√°fica correspondiente a la provincia de inter√©s</strong>, utilizando el campo <code>in1</code> como c√≥digo territorial de referencia. Este enfoque optimiza el uso de recursos y reduce los tiempos de procesamiento, evitando la descarga de capas innecesarias.
</p>
<p>
La capa utilizada corresponde a <strong><code>ign:departamento</code></strong>, que contiene informaci√≥n detallada de cada unidad administrativa departamental, incluyendo:

<ul>

<li><code>id</code> y <code>gid</code>: identificadores √∫nicos.<br></li>

<li><code>objeto</code>: tipo de entidad geogr√°fica.<br></li>

<li><code>fna</code> y <code>gna</code>: nombres del departamento.<br></li>

<li><code>nam</code>: nombre de la provincia.<br></li>

<li><code>in1</code>: c√≥digo territorial del departamento.<br></li>

<li><code>fdc</code>: fuente de los datos cartogr√°ficos.<br></li>

<li><code>sag</code>: sistema de actualizaci√≥n geogr√°fica.<br></li>

<li><code>geometry</code>: geometr√≠a en formato multipol√≠gono, sistema de referencia WGS 84 (EPSG:4326).<br></li>
</ul>
<h4><strong>Integraci√≥n y visualizaci√≥n</strong></h4>


<p>
Este enfoque presenta m√∫ltiples ventajas metodol√≥gicas. En primer lugar, permite acceder de forma automatizada y din√°mica a la capa oficial de l√≠mites administrativos departamentales del pa√≠s, evitando la necesidad de que el usuario busque, descargue y cargue manualmente archivos shapefile desde fuentes externas. Al utilizar directamente el servicio WFS del Instituto Geogr√°fico Nacional, se garantiza la utilizaci√≥n de la versi√≥n m√°s actualizada, estandarizada y validada a nivel nacional de los datos geoespaciales. Esto no solo mejora la eficiencia del flujo de trabajo, sino que tambi√©n asegura la coherencia territorial con otras fuentes oficiales y contribuye a la reproducibilidad y comparabilidad del an√°lisis en distintos contextos jurisdiccionales.
</p>
<h2><strong>7. Vigilancia Centinela</strong></h2>


<p>
Para construir la variable <strong>COLUMNA_CENTINELA</strong>, se consideran las siguientes determinaciones:
</p>
<p>
r
</p>



<pre class="prettyprint">columnas_centinela &lt;- c(
  "DETERMINACION_Detecci√≥n de Ant√≠geno de SARS CoV-2",
  "DETERMINACION_Genoma viral SARS-CoV-2",
  "DETERMINACION_Detecci√≥n molecular de Bocavirus",
  "DETERMINACION_Genoma viral de Enterovirus",
  "DETERMINACION_Genoma viral de Parainfluenza 4"
)
</pre>


<p>
Pod√©s modificar la lista seg√∫n cambios en la estrategia..
</p>
<h2><strong>7. Asignaci√≥n de √°rea programa</strong></h2>


<p>
La variable <strong>LOCALIDAD_RESIDENCIA_AREA</strong> agrupa peque√±as localidades y parajes seg√∫n su hospital de referencia.<br> Se crea utilizando <code>AREA_PROGRAMA.xlsx</code>. Si alguna localidad no tiene asignaci√≥n, se genera un reporte para su correcci√≥n manual.
</p>
<h2><strong>8. Resultados esperados del script</strong></h2>


<ul>

<li>Dataset de eventos con estructura limpia y transformada.<br></li>

<li>Variables listas para an√°lisis de s√≠ntomas, comorbilidades y determinaciones.<br></li>

<li>Grupos de edad definidos para m√∫ltiples fines.<br></li>

<li>Reporte automatizado de calidad de datos.<br></li>

<li>Modularizaci√≥n del c√≥digo para facilitar su adaptaci√≥n.<br></li>

<li>Funciones para la creaci√≥n autom√°tica de tablas y gr√°ficos.</li>
</ul>
<h2><strong>9. Observaciones finales</strong></h2>


<ul>

<li>El procesamiento de s√≠ntomas, comorbilidades y determinaciones  se realiza con la funcion <code>algoritmo_1()</code>que se encuentra en el archivo <code>funciones.R</code><br></li>

<li>Se recomienda revisar con frecuencia el archivo de √°reas programa y adaptar los templates al contexto local.<br></li>

<li>Esta gu√≠a debe actualizarse ante cambios en el modelo de datos, nomenclatura o estrategias de vigilancia.<br></li>
</ul>
